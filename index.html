<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Afiq & Farah — 6 Feb 2026</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&display=swap" rel="stylesheet">
  <style>
    :root
    {
      --bg:#ffffff;
      --fg:#111111;
      --gold:#D4AF37;
      --muted:#666;
      --panel:#f7f7f8;
      --overlay: rgba(0,0,0,.6);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Arial,sans-serif}
    a{color:var(--fg)}
    
    /* HERO VIDEO */
    .hero
    {
      position:relative;
      height:100dvh; /* full screen */
      width:100%;
      overflow:hidden;
      background:#000;
    }
    .hero video
    {
      position:absolute;inset:0;margin:auto;
      height:100%;
      width:auto;
      max-width:none;
      object-fit:cover;
    }
    .video-overlay
    {
      position:absolute;inset:0;
      display:flex;align-items:flex-start;justify-content:flex-end;
      padding:16px;
      pointer-events:none;
    }
    .video-controls{display:flex;gap:8px;pointer-events:auto;}
    .btn-circle
    {
      width:44px;height:44px;border-radius:999px;border:none;cursor:pointer;
      background:var(--overlay);color:#fff;display:grid;place-items:center;
      backdrop-filter: blur(6px);
    }
    .tap-to-play
    {
      position:absolute;inset:auto auto 24px 50%;
      transform:translateX(-50%);
      background:var(--overlay);color:#fff;padding:8px 12px;border-radius:999px;font-size:14px;
      display:none;
    }
    
    /* NAMES */
    .names{text-align:center;padding:36px 16px 8px;}
    .names h1
    {
      font-family:"Playfair Display",serif;
      font-weight:900;
      font-size:40px;line-height:1.1;margin:0;
      color:var(--gold);
      letter-spacing:.5px;
    }
    .names .meta
    {
      margin-top:8px;color:var(--muted);
      font-size:14px;
    }
    
    /* COUNTDOWN */
    .countdown
    {
      display:flex;justify-content:center;gap:10px;flex-wrap:wrap;
      padding:12px 16px 28px;
    }
    .timebox
    {
      background:var(--panel);border-radius:16px;padding:14px 16px;min-width:72px;text-align:center;
      box-shadow: 0 1px 2px rgba(0,0,0,.05), 0 6px 20px rgba(0,0,0,.04);
    }
    .timebox .num{font-size:22px;font-weight:700}
    .timebox .lab{font-size:12px;color:var(--muted)}
    
    /* BOTTOM BAR */
    .dock
    {
      position:fixed;left:0;right:0;bottom:0;
      display:grid;grid-template-columns:repeat(4,1fr);gap:6px;
      padding:10px 12px;background:rgba(255,255,255,.9);
      backdrop-filter: blur(6px);
      border-top:1px solid #e8e8e8;
      z-index:30;
    }
    .dock button
    {
      display:flex;flex-direction:column;align-items:center;gap:6px;
      border:none;background:#fff;border-radius:14px;padding:10px 8px;cursor:pointer;
      box-shadow: 0 1px 1px rgba(0,0,0,.05), 0 6px 20px rgba(0,0,0,.05);
      font-size:12px;
    }
    .dock svg{width:20px;height:20px}
    .sheet
    {
      position:relative;
      background:#fff;
      width:100%;
      max-width:720px;
      border-radius:18px 18px 0 0;
      box-shadow:0 -8px 30px rgba(0,0,0,.2);
      max-height:85dvh;overflow:auto;
    }
    .sheet .container{
      padding:20px 20px 28px;
    }
    
    /* MODAL */
    .modal{position:fixed;inset:0;display:none;align-items:flex-end;justify-content:center;z-index:40;}
    .modal.open{display:flex}
    .scrim{position:absolute;inset:0;background:rgba(0,0,0,.45)}
    .sheet
    {
      position:relative;background:#fff;width:100%;max-width:720px;border-radius:18px 18px 0 0;
      box-shadow: 0 -8px 30px rgba(0,0,0,.2);
    }
    .sheet h2{margin:4px 0 10px 0;font-family:"Playfair Display",serif;color:var(--gold)}
    .close-x{position:absolute;right:8px;top:8px;border:none;background:transparent;font-size:24px;cursor:pointer;color:#999}
    
    /* FORMS & LISTS */
    form{display:grid;gap:10px}
    input, select, textarea{border:1px solid #ddd;border-radius:12px;padding:12px;font-size:14px;width:100%;background:#fff}
    textarea{min-height:90px;resize:vertical}
    .btn{border:none;border-radius:12px;padding:12px 14px;cursor:pointer;font-weight:600}
    .btn-primary{background:var(--gold);color:#111}
    .btn-ghost{background:#f4f4f5}
    .row{display:flex;gap:10px}
    .row > *{flex:1}
    .hint{font-size:12px;color:var(--muted)}
    .list{display:grid;gap:10px;margin-top:10px}
    .card{background:var(--panel);border-radius:14px;padding:10px 12px;}
    .admin-bar{display:none;gap:8px;margin:6px 0 0}
    .admin-bar.show{display:flex}
    .tiny{font-size:11px;color:var(--muted);margin-bottom:8px}
    .hidden-admin{position:fixed;right:10px;bottom:70px;width:20px;height:20px;opacity:0;}
    
    /* FOOTER SPACE */
    .spacer{height:80px}
  </style>
</head>

<body>

  <!-- HERO (vertical) VIDEO -->
  <section class="hero" aria-label="Wedding video">
    <video id="heroVideo" playsinline muted autoplay loop preload="metadata" poster="">
      <source src="weddingfarafiq.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
    <div class="video-overlay">
      <div class="video-controls">
        <button class="btn-circle" id="togglePlay" aria-label="Pause video" title="Pause/Play">
          <!-- Play/Pause icon swaps via JS -->
          <svg id="iconPause" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="6" y="4" width="4" height="16"></rect>
            <rect x="14" y="4" width="4" height="16"></rect>
          </svg>
          <svg id="iconPlay" style="display:none" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="5,3 19,12 5,21"></polygon>
          </svg>
        </button>
      </div>
      <div id="tapToPlay" class="tap-to-play">Tap to play</div>
    </div>
  </section>

  <!-- NAMES + DATE -->
  <section class="names">
    <h1>Afiq &amp; Farah</h1>
    <div class="meta">6 February 2026 &nbsp;•&nbsp; 11:00 am &nbsp;•&nbsp; Masjid Sri Sendayan</div>
  </section>

  <!-- COUNTDOWN -->
  <section class="countdown" aria-label="Countdown to event">
    <div class="timebox"><div class="num" id="dd">0</div><div class="lab">Days</div></div>
    <div class="timebox"><div class="num" id="hh">0</div><div class="lab">Hours</div></div>
    <div class="timebox"><div class="num" id="mm">0</div><div class="lab">Minutes</div></div>
    <div class="timebox"><div class="num" id="ss">0</div><div class="lab">Seconds</div></div>
  </section>

  <div class="spacer"></div>

  <!-- BOTTOM DOCK -->
  <nav class="dock" aria-label="Actions">
    <button data-open="invitation">
      <!-- envelope -->
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
        <path d="M4 6h16v12H4z"/><path d="M22 6l-10 7L2 6"/>
      </svg>
      Invitation
    </button>
    <button data-open="rsvp">
      <!-- check -->
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
        <path d="M20 6L9 17l-5-5"/>
      </svg>
      RSVP
    </button>
    <button data-open="guestbook">
      <!-- message square -->
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
        <path d="M21 15a4 4 0 0 1-4 4H7l-4 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"/>
      </svg>
      Guestbook
    </button>
    <button data-open="location">
      <!-- map pin -->
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7">
        <path d="M12 22s7-5.5 7-12a7 7 0 0 0-14 0c0 6.5 7 12 7 12z"/>
        <circle cx="12" cy="10" r="3"/>
      </svg>
      Location
    </button>
  </nav>

  <!-- Invisible tap area to enter Admin Mode (PIN) -->
  <button class="hidden-admin" id="adminTap" title="Admin"></button>

  <!-- MODALS -->
  <!-- Invitation -->
  <div class="modal" id="modal-invitation" aria-hidden="true">
    <div class="scrim" data-close></div>
    <div class="sheet">
    <div class="container">
      <button class="close-x" data-close aria-label="Close">×</button>
      <h2>Invitation</h2>
      <p>Assalamualaikum warahmatullahi wabarakatuh &amp; Greetings,</p>
      <p>
        With joy, we invite you to celebrate the wedding of
        <strong style="color:var(--gold)">Afiq &amp; Farah</strong>.
      </p>
      <p>
        <strong>Date:</strong> 6 February 2026<br/>
        <strong>Time:</strong> 11:00 am<br/>
        <strong>Venue:</strong> Masjid Sri Sendayan
      </p>
      <p>We look forward to your presence and prayers on our special day.</p>
      <div class="tiny">Palette: White · Black · Gold</div>
      </div>
    </div>
  </div>

  <!-- RSVP -->
  <div class="modal" id="modal-rsvp" aria-hidden="true">
    <div class="scrim" data-close></div>
    <div class="sheet">
      <div class="container">
      <button class="close-x" data-close aria-label="Close">×</button>
      <h2>RSVP</h2>
      <form id="form-rsvp">
        <input type="text" name="name" placeholder="Your name" required />
        <div class="row">
          <select name="attending" required>
            <option value="" disabled selected>Will you attend?</option>
            <option>Yes</option>
            <option>No</option>
          </select>
          <input type="number" name="guests" min="0" max="10" placeholder="No. of guests" />
        </div>
        <textarea name="message" placeholder="Message (optional)"></textarea>
        <button class="btn btn-primary" type="submit">Send RSVP</button>
        <div class="hint" id="rsvpStatus"></div>
      </form>

      <div class="admin-bar" id="rsvpAdmin">
        <button class="btn btn-ghost" id="clearRSVP">Clear RSVP (Admin)</button>
      </div>

      <!--<h3 style="margin:16px 0 8px">Recent RSVPs</h3>
      <div class="list" id="rsvpList"></div>-->
      </div>
    </div>
  </div>

  <!-- Guestbook -->
  <div class="modal" id="modal-guestbook" aria-hidden="true">
    <div class="scrim" data-close></div>
    <div class="sheet">
    <div class="container">
      <button class="close-x" data-close aria-label="Close">×</button>
      <h2>Guestbook</h2>
      <form id="form-guestbook">
        <input type="text" name="name" placeholder="Your name" required />
        <textarea name="message" placeholder="Write your wishes..." required></textarea>
        <button class="btn btn-primary" type="submit">Send Message</button>
        <div class="hint" id="guestbookStatus"></div>
      </form>

      <div class="admin-bar" id="guestbookAdmin">
        <button class="btn btn-ghost" id="clearGuestbook">Clear Guestbook (Admin)</button>
      </div>

      <h3 style="margin:16px 0 8px">Messages</h3>
      <div class="list" id="guestbookList"></div>
      </div>
    </div>
  </div>

  <!-- Location -->
  <div class="modal" id="modal-location" aria-hidden="true">
    <div class="scrim" data-close></div>
    <div class="sheet">
    <div class="container">
      <button class="close-x" data-close aria-label="Close">×</button>
      <h2>Location</h2>
      <div class="tiny">Masjid Sri Sendayan</div>
      <div style="aspect-ratio:16/9;border-radius:12px;overflow:hidden;background:#eee">
        <iframe
          title="Masjid Sri Sendayan Map"
          src="https://www.google.com/maps?q=Masjid%20Sri%20Sendayan&output=embed"
          style="width:100%;height:100%;border:0;"
          allowfullscreen=""
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"></iframe>
      </div>
      <p style="margin-top:10px">
        <a target="_blank" rel="noopener" href="https://www.google.com/maps?q=Masjid%20Sri%20Sendayan">
          Open in Google Maps
        </a>
      </p>
      </div>
    </div>
  </div>

  <script>
    // ====== CONFIG ======
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbxzhC64jbecWE2kxiyWh8xe43W-LEDLVNRd0RzsSbhvbQi8DnOiAVwuxHJMlfL4JnFXbQ/exec'; // <-- replace with your /exec URL
    const EVENT_ISO = '2026-02-06T11:00:00+08:00'; // Malaysia time
    
    // ====== UTIL ======
    const $ = (q,root=document)=>root.querySelector(q);
    const $$= (q,root=document)=>Array.from(root.querySelectorAll(q));
    const fmt = n => n.toString().padStart(2,'0');

    // ====== VIDEO CONTROLS ======
    const video = $('#heroVideo');
    const toggle = $('#togglePlay');
    const iconPlay = $('#iconPlay');
    const iconPause = $('#iconPause');
    const tapToPlay = $('#tapToPlay');

    function setPausedUI(paused)
    {
      iconPlay.style.display = paused ? 'block':'none';
      iconPause.style.display = paused ? 'none':'block';
      tapToPlay.style.display = paused ? 'block':'none';
      toggle.setAttribute('aria-label', paused ? 'Play video':'Pause video');
    }
    // Autoplay policy: ensure playing on user interaction if blocked
    document.addEventListener('click', () => 
    {
      if (video.paused) video.play().catch(()=>{});
    }, { once: true });

    toggle.addEventListener('click', (e)=>
    {
      e.stopPropagation();
      if (video.paused) {
        video.play().then(()=>setPausedUI(false)).catch(()=>setPausedUI(true));
      } else {
        video.pause(); setPausedUI(true);
      }
    });
    video.addEventListener('play', ()=>setPausedUI(false));
    video.addEventListener('pause', ()=>setPausedUI(true));
    // initial hint if autostart failed
    setTimeout(()=>{ if (video.paused) setPausedUI(true); }, 800);

    // ====== COUNTDOWN ======
    const target = new Date(EVENT_ISO).getTime();
    function tick()
    {
      const now = Date.now();
      let diff = Math.max(0, target - now);
      const d = Math.floor(diff / (24*60*60*1000)); diff -= d*24*60*60*1000;
      const h = Math.floor(diff / (60*60*1000));    diff -= h*60*60*1000;
      const m = Math.floor(diff / (60*1000));       diff -= m*60*1000;
      const s = Math.floor(diff / 1000);
      $('#dd').textContent = d;
      $('#hh').textContent = fmt(h);
      $('#mm').textContent = fmt(m);
      $('#ss').textContent = fmt(s);
    }
    tick(); setInterval(tick,1000);

    // ====== MODALS ======
    const openers = $$('.dock [data-open]');
    const modals = 
    {
      invitation: $('#modal-invitation'),
      rsvp: $('#modal-rsvp'),
      guestbook: $('#modal-guestbook'),
      location: $('#modal-location'),
    };

    function openModal(key)
    {
      const m = modals[key]; if(!m) return;
      m.classList.add('open'); m.setAttribute('aria-hidden','false');
      document.body.style.overflow='hidden';
      if (key==='rsvp') { loadList('rsvp'); }
      if (key==='guestbook') { loadList('guestbook'); }
    }

    function closeModal(el)
    {
      const m = el.closest('.modal');
      m.classList.remove('open'); m.setAttribute('aria-hidden','true');
      document.body.style.overflow='';
    }

    openers.forEach(b=>b.addEventListener('click', ()=>openModal(b.dataset.open)));
    $$('[data-close]').forEach(b=>b.addEventListener('click', ()=>closeModal(b)));
    $$('.scrim').forEach(s=>s.addEventListener('click', ()=>closeModal(s)));

    // ====== ADMIN MODE (hidden, PIN-protected) ======
    let adminEnabled = false;
    const adminTap = $('#adminTap');
    adminTap.addEventListener('click', ()=>
    {
      const pin = prompt('Enter Admin PIN:');
      if (!pin) return;
      // We don't store PIN client-side; it will be checked server-side for clear actions.
      adminEnabled = true;
      $('#rsvpAdmin').classList.add('show');
      $('#guestbookAdmin').classList.add('show');
      // Keep PIN in memory for this session
      sessionStorage.setItem('adminPin', pin);
      alert('Admin mode enabled for this session.');
    });

    // ====== FETCH HELPERS ======
    async function apiGet(type){
      const url = `${GAS_URL}?type=${encodeURIComponent(type)}`;
      const res = await fetch(url, { method:'GET' });
      if (!res.ok) throw new Error('Network error (GET)');
      const data = await res.json();
      if (!data.ok) throw new Error(data.error || 'Server error');
      return data.data;
    }

    async function apiPost(payload)
    {
      const res = await fetch(GAS_URL, 
      {
        method:'POST',
        headers:{ 'Content-Type':'application/json' },
        body: JSON.stringify(payload)
      });
      if (!res.ok) throw new Error('Network error (POST)');
      const data = await res.json();
      if (!data.ok) throw new Error(data.error || 'Server error');
      return data;
    }

    // ====== RSVP FORM ======
    const formRSVP = $('#form-rsvp');
    const rsvpStatus = $('#rsvpStatus');
    formRSVP.addEventListener('submit', async (e)=>
    {
      e.preventDefault();
      rsvpStatus.textContent = 'Sending...';
      const fd = new FormData(formRSVP);
      const payload = {
        type:'rsvp',
        name: fd.get('name'),
        attending: fd.get('attending'),
        guests: Number(fd.get('guests') || 0),
        message: fd.get('message') || ''
      };
      
      try
      {
        await apiPost(payload);
        rsvpStatus.textContent = 'Thank you! Your RSVP has been recorded.';
        formRSVP.reset();
        loadList('rsvp');
      }
      
      catch(err)
      {
        rsvpStatus.textContent = 'Error: ' + err.message;
      }
    });

    // Clear RSVP (admin)
    $('#clearRSVP').addEventListener('click', async ()=>
    {
      const pin = sessionStorage.getItem('adminPin') || prompt('Admin PIN:');
      if (!pin) return;
      if (!confirm('Clear ALL RSVP responses? This cannot be undone.')) return;
      try
      {
        await apiPost({ type:'rsvp', action:'clear', pin });
        alert('RSVP cleared.');
        loadList('rsvp');
      }
      
      catch(err)
      {
        alert('Error: ' + err.message);
      }
    });

    // ====== GUESTBOOK FORM ======
    const formGB = $('#form-guestbook');
    const gbStatus = $('#guestbookStatus');
    formGB.addEventListener('submit', async (e)=>
    {
      e.preventDefault();
      gbStatus.textContent = 'Sending...';
      const fd = new FormData(formGB);
      const payload = {
        type:'guestbook',
        name: fd.get('name'),
        message: fd.get('message')
      };
      
      try
      {
        await apiPost(payload);
        gbStatus.textContent = 'Thank you for your wishes!';
        formGB.reset();
        loadList('guestbook');
      }
      
      catch(err)
      {
        gbStatus.textContent = 'Error: ' + err.message;
      }
    });

    // Clear Guestbook (admin)
    $('#clearGuestbook').addEventListener('click', async ()=>
    {
      const pin = sessionStorage.getItem('adminPin') || prompt('Admin PIN:');
      if (!pin) return;
      if (!confirm('Clear ALL guestbook messages?')) return;
      try{
        await apiPost({ type:'guestbook', action:'clear', pin });
        alert('Guestbook cleared.');
        loadList('guestbook');
      }
      
      catch(err)
      {
        alert('Error: ' + err.message);
      }
    });

    // ====== LOAD LISTS ======
    const rsvpList = $('#rsvpList');
    const guestbookList = $('#guestbookList');

    async function loadList(type)
    {
      try
      {
        const items = await apiGet(type);
        if (type==='rsvp'){
          rsvpList.innerHTML = items.slice(0,50).map(row=>{
            const when = row.Timestamp ? new Date(row.Timestamp).toLocaleString() : '';
            const attending = row.Attending || '';
            const guests = (row.Guests !== undefined && row.Guests !== '') ? ` • Guests: ${row.Guests}` : '';
            const msg = row.Message ? `<div class="hint">${escapeHTML(row.Message)}</div>` : '';
            return `<div class="card">
              <strong>${escapeHTML(row.Name||'')}</strong> — ${escapeHTML(attending)}${guests}
              <div class="tiny">${when}</div>
              ${msg}
            </div>`;
          }).join('') || `<div class="hint">No RSVPs yet.</div>`;
        } 

        else 
        {
          guestbookList.innerHTML = items.slice(0,100).map(row=>{
            const when = row.Timestamp ? new Date(row.Timestamp).toLocaleString() : '';
            return `<div class="card">
              <strong>${escapeHTML(row.Name||'')}</strong>
              <div class="tiny">${when}</div>
              <div>${escapeHTML(row.Message||'')}</div>
            </div>`;
          }).join('') || `<div class="hint">No messages yet.</div>`;
        }
      }
      catch(err)
      {
        const target = (type==='rsvp') ? rsvpList : guestbookList;
        target.innerHTML = `<div class="hint">Error loading ${type}: ${escapeHTML(err.message)}</div>`;
      }
    }

    function escapeHTML(s)
    {
      return (s||'').toString()
        .replace(/&/g,'&amp;').replace(/</g,'&lt;')
        .replace(/>/g,'&gt;').replace(/"/g,'&quot;')
        .replace(/'/g,'&#039;');
    }

    // Prefetch on idle
    if ('requestIdleCallback' in window)
    {
      requestIdleCallback(()=>{ loadList('rsvp'); loadList('guestbook'); });
    }

    // Optional: keyboard Esc closes any open modal
    document.addEventListener('keydown', e=>
    {
      if (e.key==='Escape')
      {
        Object.values(modals).forEach(m=>{
          if (m.classList.contains('open')) closeModal(m);
        });
      }
    });
  </script>
</body>
</html>






